import java.io.File
import java.nio.charset.Charset

import org.apache.commons.csv.{CSVFormat, CSVParser}
import org.apache.log4j.{Level, Logger}
import org.apache.spark.rdd.RDD
import org.apache.spark.sql.SQLContext
import org.apache.spark.{SparkConf, SparkContext}
import org.apache.spark.mllib.recommendation.{ALS, Rating, MatrixFactorizationModel}

object Experiment {
  def main(args: Array[String]) {

    Logger.getLogger("org.apache.spark").setLevel(Level.OFF)
    //    CSV.csvExperiment()
    //    MachineLearning.ALS()
    //    SQL.testSQL2()

    val samplePHPSerializedObject = "a:2:{i:0;O:50:\"PSD\\AdExternBundle\\Entity\\AdExternComponentDefault\":3:{s:21:\" * agofCodeComponents\";a:1:{i:0;O:43:\"PSD\\AdExternBundle\\Entity\\AdExternComponent\":4:{s:8:\" * title\";s:7:\"channel\";s:7:\" * code\";s:7:\"service\";s:7:\" * type\";O:47:\"PSD\\AdExternBundle\\Entity\\AdExternComponentType\":6:{s:8:\" * title\";s:7:\"channel\";s:13:\" * identifier\";s:7:\"channel\";s:11:\" * position\";i:1;s:10:\" * options\";i:11;s:16:\" * componentType\";i:2;s:13:\" * paramNames\";a:1:{i:0;s:7:\"channel\";}}s:13:\" * identifier\";s:7:\"service\";}}s:9:\" * forced\";b:1;s:8:\" * local\";b:0;}i:1;O:50:\"PSD\\AdExternBundle\\Entity\\AdExternComponentDefault\":3:{s:21:\" * agofCodeComponents\";a:1:{i:0;O:43:\"PSD\\AdExternBundle\\Entity\\AdExternComponent\":4:{s:8:\" * title\";s:3:\"7tv\";s:7:\" * code\";s:3:\"7tv\";s:7:\" * type\";O:47:\"PSD\\AdExternBundle\\Entity\\AdExternComponentType\":6:{s:8:\" * title\";s:16:\"marketingCluster\";s:13:\" * identifier\";s:16:\"marketingcluster\";s:11:\" * position\";i:27;s:10:\" * options\";i:11;s:16:\" * componentType\";i:5;s:13:\" * paramNames\";a:2:{i:0;s:16:\"marketingcluster\";i:1;s:16:\"marketingCluster\";}}s:13:\" * identifier\";i:79;}}s:9:\" * forced\";b:1;s:8:\" * local\";b:0;}}"
    val unparseableObject = "a:6:{i:0;O:50:\"PSD\\AdExternBundle\\Entity\\AdExternComponentDefault\":3:{s:21:\" * agofCodeComponents\";a:1:{i:0;O:43:\"PSD\\AdExternBundle\\Entity\\AdExternComponent\":4:{s:8:\" * title\";s:7:\"channel\";s:7:\" * code\";s:2:\"tv\";s:7:\" * type\";O:47:\"PSD\\AdExternBundle\\Entity\\AdExternComponentType\":6:{s:8:\" * title\";s:7:\"channel\";s:13:\" * identifier\";s:7:\"channel\";s:11:\" * position\";i:1;s:10:\" * options\";i:11;s:16:\" * componentType\";i:2;s:13:\" * paramNames\";a:1:{i:0;s:7:\"channel\";}}s:13:\" * identifier\";s:2:\"tv\";}}s:9:\" * forced\";b:1;s:8:\" * local\";b:0;}i:1;O:50:\"PSD\\AdExternBundle\\Entity\\AdExternComponentDefault\":3:{s:21:\" * agofCodeComponents\";a:1:{i:0;O:43:\"PSD\\AdExternBundle\\Entity\\AdExternComponent\":4:{s:8:\" * title\";s:4:\"True\";s:7:\" * code\";s:4:\"true\";s:7:\" * type\";O:47:\"PSD\\AdExternBundle\\Entity\\AdExternComponentType\":6:{s:8:\" * title\";s:11:\"popupActive\";s:13:\" * identifier\";s:11:\"popupactive\";s:11:\" * position\";i:8;s:10:\" * options\";i:11;s:16:\" * componentType\";i:1;s:13:\" * paramNames\";a:2:{i:0;s:11:\"popupactive\";i:1;s:11:\"popupActive\";}}s:13:\" * identifier\";s:4:\"true\";}}s:9:\" * forced\";b:0;s:8:\" * local\";b:0;}i:2;O:50:\"PSD\\AdExternBundle\\Entity\\AdExternComponentDefault\":3:{s:21:\" * agofCodeComponents\";a:1:{i:0;O:43:\"PSD\\AdExternBundle\\Entity\\AdExternComponent\":4:{s:8:\" * title\";s:5:\"False\";s:7:\" * code\";s:5:\"false\";s:7:\" * type\";O:47:\"PSD\\AdExternBundle\\Entity\\AdExternComponentType\":6:{s:8:\" * title\";s:16:\"fullBannerActive\";s:13:\" * identifier\";s:16:\"fullbanneractive\";s:11:\" * position\";i:15;s:10:\" * options\";i:11;s:16:\" * componentType\";i:1;s:13:\" * paramNames\";a:2:{i:0;s:16:\"fullbanneractive\";i:1;s:16:\"fullBannerActive\";}}s:13:\" * identifier\";s:5:\"false\";}}s:9:\" * forced\";b:0;s:8:\" * local\";b:0;}i:3;O:50:\"PSD\\AdExternBundle\\Entity\\AdExternComponentDefault\":3:{s:21:\" * agofCodeComponents\";a:1:{i:0;O:43:\"PSD\\AdExternBundle\\Entity\\AdExternComponent\":4:{s:8:\" * title\";s:4:\"True\";s:7:\" * code\";s:4:\"true\";s:7:\" * type\";O:47:\"PSD\\AdExternBundle\\Entity\\AdExternComponentType\":6:{s:8:\" * title\";s:16:\"skyscraperActive\";s:13:\" * identifier\";s:16:\"skyscraperactive\";s:11:\" * position\";i:17;s:10:\" * options\";i:11;s:16:\" * componentType\";i:1;s:13:\" * paramNames\";a:2:{i:0;s:16:\"skyscraperactive\";i:1;s:16:\"skyscraperActive\";}}s:13:\" * identifier\";s:4:\"true\";}}s:9:\" * forced\";b:0;s:8:\" * local\";b:0;}i:4;O:50:\"PSD\\AdExternBundle\\Entity\\AdExternComponentDefault\":3:{s:21:\" * agofCodeComponents\";a:1:{i:0;O:43:\"PSD\\AdExternBundle\\Entity\\AdExternComponent\":4:{s:8:\" * title\";s:4:\"auto\";s:7:\" * code\";s:4:\"auto\";s:7:\" * type\";O:47:\"PSD\\AdExternBundle\\Entity\\AdExternComponentType\":6:{s:8:\" * title\";s:16:\"marketingCluster\";s:13:\" * identifier\";s:16:\"marketingcluster\";s:11:\" * position\";i:27;s:10:\" * options\";i:11;s:16:\" * componentType\";i:5;s:13:\" * paramNames\";a:2:{i:0;s:16:\"marketingcluster\";i:1;s:16:\"marketingCluster\";}}s:13:\" * identifier\";i:57;}}s:9:\" * forced\";b:0;s:8:\" * local\";b:0;}i:5;O:50:\"PSD\\AdExternBundle\\Entity\\AdExternComponentDefault\":3:{s:21:\" * agofCodeComponents\";a:3:{i:0;O:43:\"PSD\\AdExternBundle\\Entity\\AdExternComponent\":4:{s:8:\" * title\";s:12:\"Popup Window\";s:7:\" * code\";s:12:\"POPUP_WINDOW\";s:7:\" * type\";O:47:\"PSD\\AdExternBundle\\Entity\\AdExternComponentType\":6:{s:8:\" * title\";s:17:\"DynamicAds except\";s:13:\" * identifier\";s:18:\"exceptofdynamicads\";s:11:\" * position\";i:26;s:10:\" * options\";i:11;s:16:\" * componentType\";i:4;s:13:\" * paramNames\";a:2:{i:0;s:18:\"exceptofdynamicads\";i:1;s:18:\"exceptOfDynamicAds\";}}s:13:\" * identifier\";s:12:\"popup_window\";}i:1;O:43:\"PSD\\AdExternBundle\\Entity\\AdExternComponent\":4:{s:8:\" * title\";s:10:\"Powerlayer\";s:7:\" * code\";s:10:\"POWERLAYER\";s:7:\" * type\";" +
      "r:91;s:13:\" * identifier\";s:10:\"powerlayer\";}i:2;O:43:\"PSD\\AdExternBundle\\Entity\\AdExternComponent\":4:{s:8:\" * title\";s:10:\"Powerpling\";s:7:\" * code\";s:10:\"POWERPLING\";" +
      "s:7:\" * type\";r:91;s:13:\" * identifier\";s:10:\"powerpling\";}}s:9:\" * forced\";b:0;s:8:\" * local\";b:0;}}"
    val cleanedUnparseableObject = unparseableObject.replaceAll("type\";r", "__r_\";r").replaceAll("r:", "i:")

    val asJSON = Parsing.parseSerializedPHPObjectToJSONString(cleanedUnparseableObject)
    println(asJSON.prettyPrint)

    //    SQL.getResultsFromMappingTable()
    SQL.test()
  }
}